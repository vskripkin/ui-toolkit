#ui
{
	.select(@font-size: 0, @postfix: ~'')
	{
		#ui-select.construct(@font-size);
		#ui-select-options.construct(@font-size, @postfix);
	}
}

#ui-select
{
	._states()
	{
		.select()
		{
			.placeholder() {};
			.default() {};
			.hover() {};
			.focus() {};
			.opened() {};
			.disabled() {};
			.readonly() {};
		}
		.select-arrow()
		{
			.default() {};
			.hover() {};
			.focus() {};
			.opened() {};
			.disabled() {};
			.readonly() {};
		}
		.value-before()
		{
			.default() {};
			.hover() {};
			.focus() {};
			.opened() {};
			.disabled() {};
			.readonly() {};
		}
		.value-after()
		{
			.default() {};
			.hover() {};
			.focus() {};
			.opened() {};
			.disabled() {};
			.readonly() {};
		}
	}

	.construct(@font-size)
	{
		.states();
		#ui-select._states();

		#ui-select.template(@font-size);


		&
		{
			.select();
			#ui-select._states.select();

			.__textfield
			{
				.default();
			}
			&:hover .__textfield
			{
				.hover();
			}
			.__textfield:focus
			{
				.focus();
			}
			&.__opened .__textfield
			{
				.opened() !important;
			}
			select:disabled + & .__textfield
			{
				.disabled() !important;
			}
			select:read-only + & .__textfield
			{
				.readonly() !important;
			}

			.__value.__placeholder
			{
				.placeholder();
			}
			.__value, .__addon
			{
				.default();
			}
		}

		&
		{
			.select-arrow();
			#ui-select._states.select-arrow();

			.__arrow
			{
				.default();
			}
			&:hover .__arrow
			{
				.hover();
			}
			& .__textfield:focus ~ .__arrow
			{
				.focus();
			}
			&.__opened .__arrow
			{
				.opened() !important;
			}
			select:disabled + & .__arrow
			{
				.disabled() !important;
			}
			select:read-only + & .__arrow
			{
				.readonly() !important;
			}
		}

		&
		{
			.value-before();
			#ui-select._states.value-before();

			.__value:before
			{
				.default();
			}
			&:hover .__value:before
			{
				.hover();
			}
			.__textfield:focus .__value:before
			{
				.focus();
			}
			select:disabled + & .__textfield ~ .__value:before
			{
				.disabled() !important;
			}
			select:read-only + & .__textfield ~ .__value:before
			{
				.readonly() !important;
			}
		}

		&
		{
			.value-after();
			#ui-select._states.value-after();

			.__value:after
			{
				.default();
			}
			&:hover .__value:after
			{
				.hover();
			}
			.__textfield:focus .__value:after
			{
				.focus();
			}
			select:disabled + & .__textfield ~ .__value:after
			{
				.disabled() !important;
			}
			select:read-only + & .__textfield ~ .__value:after
			{
				.readonly() !important;
			}
		}
	}

	.template(@font-size)
	{
		font-size: @font-size;
	}
	.template(...)
	{
		display: inline-block;
		vertical-align: middle;
		position: relative;
		z-index: 1;
		width: auto;
		max-width: 100%;
		cursor: pointer;

		select:disabled + &
		{
			cursor: @textfield-disabled-cursor;
		}

		// for mobile devices
		select
		{
			position: absolute;
			z-index: 1;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			opacity: 0;
			width: 100%;
			height: 100%;
		}

		.__textfield
		{
			#ui-textfield.template();

			position: absolute;
			z-index: 1;
			top: 0;
			left: 0;
			width: 100% !important;
			height: 100%;

			&:read-only
			{
				cursor: inherit !important;
				color: transparent !important;
			}
		}

		.__inner
		{
			display: flex;
			flex-flow: row nowrap;
			min-width: auto;
			max-width: 100%;
		}

		.__value
		{
			flex: 1 1 0%;
		}
		.__addon, .__arrow
		{
			flex: 0 0 auto;
		}
		.__addon.__left  { order: -1; }
		.__addon.__right { order:  1; }
		.__arrow         { order:  2; }

		.__value, .__addon, .__arrow
		{
			width: auto;
			min-width: auto;
			max-width: 100%;
			overflow: hidden;
		}


		.__value, .__addon
		{
			pointer-events: none;
			position: relative;
			z-index: 2;
			line-height: @textfield-line-height !important;
			border-radius: 0 !important;
			border-color: transparent !important;
			background: transparent !important;
			box-shadow: none !important;
		}
		.__value
		{
			text-align: left;
			text-overflow: ellipsis;
			white-space: nowrap;
		}
		.__addon
		{
			&.__left
			{
				text-align: left;
				padding-right: 0.5em;
			}
			&.__right
			{
				text-align: right;
				padding-left: 0.5em;
			}
		}

		.__arrow
		{
			position: relative;
			text-align: center;
			transition: transform 0.3s ease;
			transform: rotate(0deg);

			#ui.spaces-no(nowrap);

			&:before, i
			{
				#ui.spaces-yes();
				vertical-align: middle;
			}
			&:before
			{
				content: '';
				height: 100%;
			}
			i
			{
				line-height: 1;
			}
		}

		.__value[data-before]:before
		{
			content: attr(data-before);
		}
		.__value[data-after]:after
		{
			content: attr(data-after);
		}
		.__value.__placeholder:before, .__value.__placeholder:after
		{
			content: none !important;
		}

		&.__open.__under,
		&.__open.__under .__textfield,
		&.__open.__under .__arrow
		{
			border-bottom-left-radius: 0 !important;
			border-bottom-right-radius: 0 !important;
		}
		&.__open.__above,
		&.__open.__above .__textfield,
		&.__open.__above .__arrow
		{
			border-top-left-radius: 0 !important;
			border-top-right-radius: 0 !important;
		}
		&.__open.__above .__arrow
		{
			transform: rotate(180deg);
		}
	}


	.size(@fs: 0, @pv: 0, @ph: 0)
	{
		& when not (@fs = 0)
		{
			#ui.size-custom(@fs, @pv, @ph);

			&
			{
				.normal();
				#ui-select._size(@font-size, @padding-ver, @padding-hor, @height);
			}
			&.large
			{
				.large();
				#ui-select._size(@font-size, @padding-ver, @padding-hor, @height);
			}
			&.small
			{
				.small();
				#ui-select._size(@font-size, @padding-ver, @padding-hor, @height);
			}
		}
	}
	._size(@font-size, @padding-ver, @padding-hor, @height)
	{
		.__textfield, .__value, .__addon
		{
			font-size: @font-size;
		}
		&, .__textfield
		{
			padding: @padding-ver @height @padding-ver @padding-hor;
		}

		.__arrow
		{
			width: @height;

			.material-icons
			{
				font-size: @font-size * 1.6;
			}
		}
	}
}

#ui-select-options
{
	._list()
	{
		.default() {};
		.is-nested() {};
		.under() {};
		.above() {};
	}
	._list-label()
	{
		.default() {};
		.hover() {};
	}
	._item-states()
	{
		.default() {};
		.hover() {};
		.disabled() {};

		.in-optgroup() {};
		.has-nested() {};
		.selected() {};
	}

	.construct(@font-size, @postfix)
	{
		&@{postfix}
		{
			.__list()
			{
				.list();
				#ui-select-options._list();
			}
			.__list-label()
			{
				.list-label();
				#ui-select-options._list-label();
			}
			.__list-item()
			{
				.list-item();
				#ui-select-options._item-states();
			}

			#ui-select-options.template();

			&
			{
				.__list();

				&
				{
					.default();
				}
				&.__under
				{
					.under();
				}
				&.__above
				{
					.above();
				}
			}

			.__label
			{
				.__list-label();

				&
				{
					.default();
				}
				&:hover
				{
					.hover();
				}
			}

			.__option
			{
				.__list-item();

				&
				{
					.default();
				}
				&:hover
				{
					.hover();
				}
				&.__in-optgroup
				{
					.in-optgroup();
				}
				&.__has-nested
				{
					.has-nested();
				}
				&.__selected
				{
					.selected();
				}
				&[disabled]
				{
					.disabled();
				}
			}
		}
	}

	.template()
	{
		#ui.dropdown-list();

		&, ul
		{
			width: auto !important;
			overflow-x: hidden;
			overflow-y: auto;
			min-width: 0;
			max-height: 40rem;

			&.__with-attr.__option:after
			{
				content: ' - 'attr(data-value);
				font-size: 0.9em;
			}
		}

		&.__scroll
		{
			overflow-x: hidden !important;
			overflow-y: scroll !important;
		}

		&.__with-nested
		{
			max-height: none;
			overflow: visible !important;
		}

		&.__decimal
		{
			counter-reset: option_num;

			&.__option
			{
				display: table;
				width: 100%;
				word-break: break-word;

				&:before
				{
					counter-increment: option_num;
					content: counter(option_num)'.';
					display: table-cell;
					width: 1px;
					padding-right: 0.5rem;
					white-space: nowrap;
				}
			}
		}

		&.__oneline
		{
			&, ul
			{
				max-width: none !important;

				&.option
				{
					white-space: nowrap;
					word-break: normal;
				}
			}
		}
	}


	.size(@item-fs:  0, @item-pv:  0, @item-ph:  0,
		  @label-fs: 0, @label-pv: 0, @label-ph: 0)
	{
		& when not (@label-fs = 0)
		{
			#ui.size-font-padding(@label-fs, @label-pv, @label-ph);

			&       .__label { @normal(); }
			&.large .__label { @large();  }
			&.small .__label { @small();  }
		}
		& when not (@item-fs = 0)
		{
			#ui.size-font-padding(@item-fs, @item-pv, @item-ph);
			#ui.size-custom(@item-fs, @item-pv, @item-ph);

			& .__option
			{
				@normal();

				&.__with-nested
				{
					.normal();
					padding-right: @height;
				}
			}
			&.large .__option
			{
				@large();

				&.__with-nested
				{
					.large();
					padding-right: @height;
				}
			}
			&.small .__option
			{
				@small();

				&.__with-nested
				{
					.small();
					padding-right: @height;
				}
			}
		}
	}
}
